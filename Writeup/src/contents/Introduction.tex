\chapter{Introduction}

\textit{\textbf{Disclaimer:} I assume you solved or at least tried to solve the binary before reading this document. Its main purpose is purely educational and it is intended to help you learn and further your knowledge.}

In this first chapter we will see what this binary is all about and introduce the main concepts needed in order to solve it. 

\section{Challenge description}
\begin{itemize}
	\item[\textbf{Title:}]{Integer Operations}
	\item[\textbf{Description:}]{You are back to school learning about addition, subtraction and equations with integers. You'll have to fully understand how they behave in order to pass the exam.}
\end{itemize}

The name of the binary/challenge as well as its description are a good hint and starting point.  \textit{Integer operations} and \textit{how integers behave} are clear references to the well-known vulnerability/software bug \emph{\textbf{Integer Overflow}}.

\section{Integer Overflow}

There is a lot of info about integer overflows/underflows, why the occur in memory, how to exploit them, how to avoid them, etc... But I consider the following references as the main ones to start understanding it:
\begin{enumerate}
	\item{Basic Integer Overflow by Blexim. Published in Phrack\#60~\cite{Blexim2002}.}
	\item{Understanding Integer Overflows in C/C++ by Dietz, Li, Regehr and Adve~\cite{dietz2015understanding}.}
	\item{Integer Overflow overview autogenerated by Science Direct~\cite{IntegerOverflowScienceDirect}.}
	\item{Integer Overflow entry on Wikiedia~\cite{IntegerOverflowWikipedia}. Even though Wikipedia has bad reputation, the entry about Integer Overflows is pretty good and very useful to read discover other references and resources (bottom of the page).}
\end{enumerate}

Broadly speaking, integer overflows/underflows occur when a given number is stored in a certain data type that it does not fit into. That is, a number bigger than the maximum integer (\code{int}) value or a number lesser than the minimum integer value pretended to be assigned to a \code{int} variable. They can also appear when signed data types are treated as unsigned or viceversa. 

Integer overflows are a type of numerical software errors/bugs. ``\textit{These errors include
overflows, underflows, lossy truncations (e.g., a cast of an
int to a short in C++ that results in the value being
changed), and illegal uses of operations such as shifts (e.g.,
shifting a value in C by at least as many positions as its
bitwidth).}''~\cite{dietz2015understanding}.

Back in 2002, Blexim categorized these numerical errors into: 1) Integer overflows and 2) Signedness bugs~\cite{Blexim2002}. According to him/her, ``\textit{an integer overflow is the result of attempting to store a value in a variable which is too small to hold it}''. Two typew of integer overflows were described:
\begin{itemize}
	\item{Widthness overflows. They occur when a variable of a given size (width) like \code{int} which is typically 32 bits long, is assigned to a smaller variable like \code{short}, which is typically 16 bits long. Blexim also talks about \textit{truncation} and \textit{integer promotion/demotion} that are quite important concepts. }
	\item{Arithmetic overflows. They occur when the result of an arithmetic operation is bigger than the data type of the variable it will be stored into.}
\end{itemize}

On the other hand, signedness bugs ``\textit{occur when an unsigned variable is interpreted as signed, or when a signed variable is interpreted as unsigned.  This type of behaviour can happen because internally to the computer, there is no distinction between the way signed and unsigned variables are stored.}''

As it was aforementioned, there is plenty of literature about integer overflows. It is a well known vulnerability/bug and, as such, there are plenty of public recommendations to deal with it. The Common Weakness Enumeration\footnote{\url{https://cwe.mitre.org/index.html}} (CWE)   defines various weaknesses that involve integer overflows or other types of numerical errors. Table \ref{table:cwe_integers} shows some of these weaknesses (there are many more in the CWE's INT category\footnote{\url{https://cwe.mitre.org/data/definitions/1158.html}}). Moreover, the weakness Integer Overflow or Wraparound (CWE-190) is placed 8th in the 2019 CWE Top 25 Most Dangerous Software Errors~\cite{Top25CWE2019} ranking.

\begin{table}[!h]
	\centering
	\caption{CWE Weaknesses involving integer and numerical errors. (Source: CWE CATEGORY: INT)}
	\label{table:cwe_integers}
	\begin{tabular}{ll}
		\toprule
			\textbf{Identifier} & \textbf{Title}\\
		\midrule
			CWE-190 & Integer Overflow or Wraparound\\
			CWE-191 & Integer Underflow or Wraparound\\
			CWE-192 & Integer Coercion Error\\
			CWE-194 & Unexpected Sign Extension\\
			CWE-195 & Signed to Unsigned Conversion Error\\
			CWE-197 & Numeric Truncation Error\\
			CWE-680 & Integer Overflow to Buffer Overflow\\
		\bottomrule
	\end{tabular}
\end{table}